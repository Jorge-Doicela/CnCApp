<ion-header>
  <ion-toolbar color="primary">
    <ion-buttons slot="start">
      <ion-back-button default-href="/home"></ion-back-button>
    </ion-buttons>
    <ion-title class="ion-text-center">Servicios y Programas</ion-title>
  </ion-toolbar>
</ion-header>
<ion-content class="ion-padding">
  <div class="logo-container ion-text-center">
    <img src="assets/cnc.png" alt="Logo CNC" class="cnc-logo">
  </div>
  <!-- Tabs para navegar entre servicios y programas -->
  <ion-segment [(ngModel)]="selectedSegment" (ionChange)="segmentChanged()">
    <ion-segment-button value="servicios">
      <ion-label>Servicios</ion-label>
      <ion-icon name="briefcase-outline"></ion-icon>
    </ion-segment-button>
    <ion-segment-button value="programas">
      <ion-label>Programas</ion-label>
      <ion-icon name="school-outline"></ion-icon>
    </ion-segment-button>
    <ion-segment-button value="eventos">
      <ion-label>Eventos</ion-label>
      <ion-icon name="calendar-outline"></ion-icon>
    </ion-segment-button>
  </ion-segment>
  <!-- Contenido de Servicios -->
  <div *ngIf="selectedSegment === 'servicios'">
    <ion-card class="intro-card">
      <ion-card-header>
        <ion-card-title>Servicios del CNC</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <p>El Consejo Nacional de Competencias ofrece diversos servicios para apoyar a los Gobiernos Autónomos
          Descentralizados en el ejercicio de sus competencias y fortalecer la gestión descentralizada.</p>
      </ion-card-content>
    </ion-card>
    <div class="services-grid">
      <ion-card class="service-card" (click)="verDetalleServicio('asistencia')">
        <div class="service-icon">
          <ion-icon name="people-outline" color="primary"></ion-icon>
        </div>
        <ion-card-header>
          <ion-card-title>Asistencia Técnica</ion-card-title>
        </ion-card-header>
        <ion-card-content>
          <p>Apoyo técnico especializado para el ejercicio eficiente de competencias transferidas.</p>
          <ion-button fill="clear" color="primary">
            Ver más <ion-icon name="arrow-forward" slot="end"></ion-icon>
          </ion-button>
        </ion-card-content>
      </ion-card>
      <ion-card class="service-card" (click)="verDetalleServicio('fortalecimiento')">
        <div class="service-icon">
          <ion-icon name="fitness-outline" color="primary"></ion-icon>
        </div>
        <ion-card-header>
          <ion-card-title>Fortalecimiento Institucional</ion-card-title>
        </ion-card-header>
        <ion-card-content>
          <p>Desarrollo de capacidades institucionales para mejorar la gestión pública descentralizada.</p>
          <ion-button fill="clear" color="primary">
            Ver más <ion-icon name="arrow-forward" slot="end"></ion-icon>
          </ion-button>
        </ion-card-content>
      </ion-card>
      <ion-card class="service-card" (click)="verDetalleServicio('monitoreo')">
        <div class="service-icon">
          <ion-icon name="analytics-outline" color="primary"></ion-icon>
        </div>
        <ion-card-header>
          <ion-card-title>Monitoreo y Evaluación</ion-card-title>
        </ion-card-header>
        <ion-card-content>
          <p>Seguimiento al ejercicio de competencias y evaluación de capacidad operativa de los GAD.</p>
          <ion-button fill="clear" color="primary">
            Ver más <ion-icon name="arrow-forward" slot="end"></ion-icon>
          </ion-button>
        </ion-card-content>
      </ion-card>
      <ion-card class="service-card" (click)="verDetalleServicio('conflictos')">
        <div class="service-icon">
          <ion-icon name="shield-outline" color="primary"></ion-icon>
        </div>
        <ion-card-header>
          <ion-card-title>Resolución de Conflictos</ion-card-title>
        </ion-card-header>
        <ion-card-content>
          <p>Mediación y resolución de conflictos de competencias entre diferentes niveles de gobierno.</p>
          <ion-button fill="clear" color="primary">
            Ver más <ion-icon name="arrow-forward" slot="end"></ion-icon>
          </ion-button>
        </ion-card-content>
      </ion-card>
    </div>
  </div>
  <!-- Contenido de Programas -->
  <div *ngIf="selectedSegment === 'programas'">
    <ion-card class="intro-card">
      <ion-card-header>
        <ion-card-title>Programas de Fortalecimiento</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <p>Los programas de fortalecimiento del CNC están diseñados para desarrollar capacidades en los GAD y mejorar la
          calidad de los servicios públicos en territorio.</p>
      </ion-card-content>
    </ion-card>
    <!-- Programas principales (siempre visibles) -->
    <ion-card class="program-card" (click)="verDetallePrograma('capacitacion')">
      <ion-card-header>
        <ion-card-title>
          <ion-icon name="school-outline" color="primary"></ion-icon>
          Programa de Capacitación
        </ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <div class="program-image">
          <img src="assets/servicios/capacitacion.jpg" alt="Programa de Capacitación">
        </div>
        <div class="program-description">
          <p>Formación continua para autoridades y funcionarios de los GAD en temas relacionados con sus competencias y
            gestión pública.</p>
          <h4>Modalidades:</h4>
          <div class="modalities">
            <div class="modality-item">
              <ion-icon name="laptop-outline"></ion-icon>
              <span>Virtual</span>
            </div>
            <div class="modality-item">
              <ion-icon name="people-outline"></ion-icon>
              <span>Presencial</span>
            </div>
            <div class="modality-item">
              <ion-icon name="sync-outline"></ion-icon>
              <span>Mixta</span>
            </div>
          </div>
          <h4>Áreas temáticas:</h4>
          <ul>
            <li>Gestión de competencias descentralizadas</li>
            <li>Administración pública</li>
            <li>Planificación territorial</li>
            <li>Finanzas públicas</li>
            <li>Gobernanza local</li>
          </ul>
          <ion-button fill="clear" color="primary">
            Ver cursos disponibles <ion-icon name="arrow-forward" slot="end"></ion-icon>
          </ion-button>
        </div>
      </ion-card-content>
    </ion-card>
    <ion-card class="program-card" (click)="verDetallePrograma('asistencia')">
      <ion-card-header>
        <ion-card-title>
          <ion-icon name="build-outline" color="primary"></ion-icon>
          Programa de Asistencia Técnica
        </ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <div class="program-image">
          <img src="assets/servicios/asistencia.jpg" alt="Programa de Asistencia Técnica">
        </div>
        <div class="program-description">
          <p>Acompañamiento técnico especializado para el ejercicio efectivo de competencias y la implementación de
            proyectos.</p>
          <h4>Componentes:</h4>
          <ul>
            <li>Diagnóstico de capacidades institucionales</li>
            <li>Desarrollo de modelos de gestión</li>
            <li>Asesoría técnica especializada</li>
            <li>Implementación de sistemas y herramientas</li>
          </ul>
          <ion-button fill="clear" color="primary">
            Solicitar asistencia técnica <ion-icon name="arrow-forward" slot="end"></ion-icon>
          </ion-button>
        </div>
      </ion-card-content>
    </ion-card>
    <ion-card class="program-card" (click)="verDetallePrograma('intercambio')">
      <ion-card-header>
        <ion-card-title>
          <ion-icon name="swap-horizontal-outline" color="primary"></ion-icon>
          Programa de Intercambio de Experiencias
        </ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <div class="program-image">
          <img src="assets/servicios/intercambio.jpg" alt="Programa de Intercambio">
        </div>
        <div class="program-description">
          <p>Promoción del intercambio de buenas prácticas y experiencias exitosas entre gobiernos autónomos
            descentralizados.</p>
          <h4>Actividades:</h4>
          <ul>
            <li>Encuentros territoriales</li>
            <li>Foros de buenas prácticas</li>
            <li>Visitas técnicas</li>
            <li>Documentación de experiencias exitosas</li>
          </ul>
          <ion-button fill="clear" color="primary">
            Conocer experiencias destacadas <ion-icon name="arrow-forward" slot="end"></ion-icon>
          </ion-button>
        </div>
      </ion-card-content>
    </ion-card>
    <!-- Más programas (mostrados cuando se hace clic en "Ver más programas") -->
    <div *ngIf="showAllPrograms">
      <ion-card class="program-card" *ngFor="let programa of programasAdicionales"
        (click)="verDetallePrograma(programa.id)">
        <ion-card-header>
          <ion-card-title>
            <ion-icon [name]="programa.icono" color="primary"></ion-icon>
            {{programa.titulo}}
          </ion-card-title>
        </ion-card-header>
        <ion-card-content>
          <div class="program-image">
            <img src="assets/servicios/{{programa.imagen}}" alt="{{programa.titulo}}">
          </div>
          <div class="program-description">
            <p>{{programa.descripcion}}</p>
            <h4 *ngIf="programa.componentes">Componentes:</h4>
            <ul *ngIf="programa.componentes">
              <li *ngFor="let componente of programa.componentes">{{componente}}</li>
            </ul>
            <h4 *ngIf="programa.areas">Áreas temáticas:</h4>
            <ul *ngIf="programa.areas">
              <li *ngFor="let area of programa.areas">{{area}}</li>
            </ul>
            <ion-button fill="clear" color="primary">
              Ver más detalles <ion-icon name="arrow-forward" slot="end"></ion-icon>
            </ion-button>
          </div>
        </ion-card-content>
      </ion-card>
    </div>
    <!-- Botón para ver más o menos programas -->
    <ion-card class="ver-mas-card" (click)="toggleShowAllPrograms()">
      <ion-card-content class="ion-text-center">
        <ion-icon [name]="showAllPrograms ? 'chevron-up-outline' : 'chevron-down-outline'" color="primary"></ion-icon>
        <p>{{ showAllPrograms ? 'Ver menos programas' : 'Ver más programas' }}</p>
      </ion-card-content>
    </ion-card>
  </div>
  <!-- Contenido de Eventos -->
  <div *ngIf="selectedSegment === 'eventos'">
    <ion-card class="intro-card">
      <ion-card-header>
        <ion-card-title>Calendario de Eventos</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <p>Conozca los próximos eventos organizados por el Consejo Nacional de Competencias para el fortalecimiento de
          la descentralización.</p>
        <div class="filter-container">
          <ion-item class="filter-item">
            <ion-icon name="filter-outline" slot="start" color="primary"></ion-icon>
            <ion-label>Filtrar por tipo</ion-label>
            <ion-select [(ngModel)]="filtroEvento" (ionChange)="filtrarEventos()" interface="action-sheet"
              placeholder="Todos">
              <ion-select-option value="todos">Todos</ion-select-option>
              <ion-select-option value="capacitacion">Capacitación</ion-select-option>
              <ion-select-option value="foro">Foros y Seminarios</ion-select-option>
              <ion-select-option value="taller">Talleres</ion-select-option>
            </ion-select>
          </ion-item>
        </div>
      </ion-card-content>
    </ion-card>
    <div class="events-list">
      <!-- Mostrar eventos filtrados -->
      <ion-card class="event-card" *ngFor="let evento of filteredEventos" (click)="verDetalleEvento(evento.id)">
        <div class="event-date">
          <div class="event-month">{{evento.mes}}</div>
          <div class="event-day">{{evento.dia}}</div>
          <div class="event-year">2025</div>
        </div>
        <div class="event-content">
          <h3>{{evento.titulo}}</h3>
          <div class="event-details">
            <div class="event-detail">
              <ion-icon name="time-outline"></ion-icon>
              <span>{{evento.hora}}</span>
            </div>
            <div class="event-detail">
              <ion-icon name="location-outline"></ion-icon>
              <span>{{evento.lugar}}</span>
            </div>
            <div class="event-detail">
              <ion-icon name="people-outline"></ion-icon>
              <span>{{evento.dirigido}}</span>
            </div>
          </div>
          <div class="event-status">
            <div class="event-badge">{{evento.tipo.charAt(0).toUpperCase() + evento.tipo.slice(1)}}</div>
            <div *ngIf="evento.estado === 'expirado'" class="event-status-badge">Finalizado</div>
            <div *ngIf="evento.estado === 'programado'" class="event-status-badge active">Programado</div>
          </div>
        </div>
      </ion-card>
      <!-- Mensaje si no hay eventos que coincidan con el filtro -->
      <div *ngIf="filteredEventos.length === 0" class="no-events-message">
        <ion-icon name="calendar-outline" color="medium"></ion-icon>
        <p>No hay eventos que coincidan con el filtro seleccionado</p>
      </div>
    </div>
    <ion-button expand="block" color="primary" class="ver-todos-button" (click)="verTodosEventos()">
      <ion-icon name="calendar" slot="start"></ion-icon>
      Ver todos los eventos
    </ion-button>
  </div>
</ion-content>