<ion-header class="ion-no-border" [translucent]="true">
  <ion-toolbar class="glass-header">
    <ion-buttons slot="start">
      <ion-button routerLink="/home" color="primary">
        <ion-icon name="arrow-back-outline" slot="icon-only"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-title class="header-title">
      <img src="assets/certificados/cnc.png" alt="Logo CNC" class="header-logo">
      <span>Validación de Certificados</span>
    </ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="main-content">
  <div class="background-decor-1"></div>
  <div class="background-decor-2"></div>

  <div class="content-wrapper ion-padding">

    <div class="page-header animate-fade-up">

      <h1>Verificación de Certificados Oficiales</h1>
      <p class="subtitle">Bienvenido a la página oficial de validación de certificados del Consejo Nacional de
        Competencias (CNC)</p>
    </div>

    <div class="grid-layout">

      <!-- Columna Izquierda: Información y Pasos -->
      <div class="info-column animate-fade-up" style="animation-delay: 0.1s;">

        <div class="modern-card info-card">
          <div class="card-icon-wrapper blue">
            <ion-icon name="shield-checkmark-outline"></ion-icon>
          </div>
          <div class="card-content">
            <h3>Certificados Digitales Oficiales</h3>
            <p>Este certificado fue generado digitalmente y es completamente válido. Contiene información autenticada
              por el sistema del CNC. Si ha llegado aquí escaneando un código QR, puede considerar este documento como
              oficial y verificable.</p>
          </div>
        </div>

        <div class="modern-card steps-card">
          <h3>¿Cómo verificar un certificado?</h3>

          <div class="steps-list">
            <div class="step-item">
              <div class="step-badge">1</div>
              <div class="step-text">
                <h4>Localice el código QR</h4>
                <p>Cada certificado incluye un código QR en la esquina superior derecha.</p>
              </div>
            </div>

            <div class="step-item">
              <div class="step-badge">2</div>
              <div class="step-text">
                <h4>Escanee el código</h4>
                <p>Utilice la cámara de su dispositivo para escanear el código QR.</p>
              </div>
            </div>

            <div class="step-item">
              <div class="step-badge">3</div>
              <div class="step-text">
                <h4>Verifique la autenticidad</h4>
                <p>El sistema verificará automáticamente la validez del certificado.</p>
              </div>
            </div>
          </div>
        </div>

      </div>

      <!-- Columna Derecha: Formulario y Resultados -->
      <div class="validation-column animate-fade-up" style="animation-delay: 0.2s;">

        <!-- Formulario -->
        <div class="modern-card validation-form-card">
          <div class="form-header">
            <h3>Validar certificado manualmente</h3>
            <p>Ingrese el código único del documento</p>
          </div>

          <div class="input-group">
            <ion-item lines="none" class="custom-input">
              <ion-icon name="key-outline" slot="start" color="primary"></ion-icon>
              <ion-label position="stacked">Código de verificación</ion-label>
              <ion-input [(ngModel)]="hashCode" placeholder="Ej: A1B2-C3D4-E5F6"></ion-input>
            </ion-item>
          </div>

          <ion-button expand="block" shape="round" class="validate-btn" (click)="validarCertificado()"
            [disabled]="isLoading || !hashCode">
            <span *ngIf="!isLoading">Verificar Certificado</span>
            <ion-spinner name="crescent" *ngIf="isLoading"></ion-spinner>
          </ion-button>
        </div>

        <!-- Resultados -->
        <div class="modern-card result-card" *ngIf="resultadoValidacion"
          [ngClass]="{'valid': esValido, 'invalid': !esValido}">

          <div class="result-header">
            <div class="result-icon-wrapper">
              <ion-icon [name]="esValido ? 'checkmark-circle' : 'alert-circle'"></ion-icon>
            </div>
            <div class="result-title">
              <h4>{{ esValido ? 'Certificado Válido' : 'Certificado No Válido' }}</h4>
              <p>{{ mensajeValidacion }}</p>
            </div>
          </div>

          <div class="certificate-details" *ngIf="esValido && certificadoData">
            <div class="detail-row">
              <span class="label">Expedido a:</span>
              <span class="value person-name">{{ certificadoData.Usuario?.Nombre_Usuario }}</span>
            </div>

            <div class="separator"></div>

            <div class="detail-grid">
              <div class="detail-item">
                <ion-icon name="calendar-outline"></ion-icon>
                <div class="detail-text">
                  <span class="label">Fecha</span>
                  <span class="value">{{ formatearFecha(certificadoData.Fecha_generado) }}</span>
                </div>
              </div>

              <div class="detail-item">
                <ion-icon name="time-outline"></ion-icon>
                <div class="detail-text">
                  <span class="label">Duración</span>
                  <span class="value">{{ capacitacionData?.Horas || 'N/A' }} horas</span>
                </div>
              </div>
            </div>

            <div class="detail-row full-width">
              <span class="label">Capacitación:</span>
              <span class="value course-name">{{ capacitacionData?.Nombre_Capacitacion || 'No disponible' }}</span>
            </div>

          </div>

        </div>

      </div>

    </div>

  </div>
</ion-content>