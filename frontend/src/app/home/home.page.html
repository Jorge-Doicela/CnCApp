<ion-header class="ion-no-border">
  <ion-toolbar class="main-header">
    <div class="header-container">
      <div class="logo-section">
        <img src="assets/cnc.png" alt="CNC Logo" class="header-logo">
        <div class="header-text">
          <h1>Consejo Nacional de Competencias</h1>
          <p>República del Ecuador</p>
        </div>
      </div>

      <div class="header-actions">
        <ion-button fill="clear" color="dark" *ngIf="!userName()" (click)="iraLogin()">
          <ion-icon name="log-in-outline" slot="start"></ion-icon>
          Ingresar
        </ion-button>
        <div class="user-profile" *ngIf="userName()">
          <span class="welcome-text">Hola, {{ userName() }}</span>
          <ion-button fill="clear" color="primary" (click)="actualizarTitulo()">
            <ion-icon name="person-circle-outline" size="large"></ion-icon>
          </ion-button>
        </div>
      </div>
    </div>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="bg-light">

  <!-- Hero Section -->
  <div class="hero-section">
    <div class="hero-content">
      <div class="hero-text animate__animated animate__fadeInLeft">
        <h2>Fortaleciendo la Descentralización</h2>
        <p>Trabajamos por un Ecuador más equitativo y territorialmente integrado.</p>

        <div class="search-box">
          <ion-icon name="search-outline"></ion-icon>
          <input type="text" placeholder="¿Qué estás buscando? Ej: Capacitaciones, Certificados...">
          <button>Buscar</button>
        </div>
      </div>
      <div class="hero-image animate__animated animate__fadeInRight">
        <!-- Placeholder for hero illustration -->
        <ion-icon name="map-outline" class="hero-icon"></ion-icon>
      </div>
    </div>

    <div class="wave-shape">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320">
        <path fill="#f8f9fa" fill-opacity="1"
          d="M0,96L48,112C96,128,192,160,288,160C384,160,480,128,576,112C672,96,768,96,864,112C960,128,1056,160,1152,160C1248,160,1344,128,1392,112L1440,96L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z">
        </path>
      </svg>
    </div>
  </div>

  <!-- DASHBOARD CONTENT (For Authenticated Users) -->
  <div class="dashboard-section container section-padding pb-0" *ngIf="userName()">

    <!-- Stats Row -->
    <div class="stats-row">
      <!-- User Stats -->
      <ng-container *ngIf="roleName() !== 'Administrador' && roleName() !== 'administrador'">
        <div class="stat-card-modern">
          <div class="stat-icon-wrapper blue">
            <ion-icon name="calendar-outline"></ion-icon>

          </div>
          <div class="stat-info">
            <h3>{{ ConferenciasInscritas.length }}</h3>
            <p>Mis Conferencias</p>
          </div>
        </div>
        <div class="stat-card-modern">
          <div class="stat-icon-wrapper green">
            <ion-icon name="timer-outline"></ion-icon>
          </div>
          <div class="stat-info">
            <h3>{{ proximasConferencias }}</h3>
            <p>Próximas</p>
          </div>
        </div>
        <div class="stat-card-modern">
          <div class="stat-icon-wrapper orange">
            <ion-icon name="ribbon-outline"></ion-icon>
          </div>
          <div class="stat-info">
            <h3>{{ certificadosDisponibles }}</h3>
            <p>Certificados</p>
          </div>
        </div>
      </ng-container>

      <!-- Admin Stats -->
      <ng-container *ngIf="roleName() === 'Administrador' || roleName() === 'administrador'">
        <div class="stat-card-modern">
          <div class="stat-icon-wrapper blue">
            <ion-icon name="people-outline"></ion-icon>
          </div>
          <div class="stat-info">
            <h3>{{ usuariosCount }}</h3>
            <p>Usuarios</p>
          </div>
        </div>
        <div class="stat-card-modern">
          <div class="stat-icon-wrapper green">
            <ion-icon name="calendar-outline"></ion-icon>
          </div>
          <div class="stat-info">
            <h3>{{ conferenciasCount }}</h3>
            <p>Conferencias</p>
          </div>
        </div>
        <div class="stat-card-modern">
          <div class="stat-icon-wrapper orange">
            <ion-icon name="document-text-outline"></ion-icon>
          </div>
          <div class="stat-info">
            <h3>{{ certificadosCount }}</h3>
            <p>Certificados</p>
          </div>
        </div>
      </ng-container>
    </div>

    <!-- User Dashboard Content: Conferences Lists -->
    <ng-container *ngIf="roleName() !== 'Administrador' && roleName() !== 'administrador'">

      <!-- Available Conferences -->
      <div class="content-block" *ngIf="capacitacionesDisponibles.length > 0">
        <div class="block-header">
          <h3>Conferencias Disponibles</h3>
          <a class="view-all" (click)="navegarModulo('Ver conferencias')">Ver todas</a>
        </div>

        <div class="horizontal-scroll-container">
          <div class="conference-card-mini" *ngFor="let capacitacion of capacitacionesDisponibles">
            <div class="card-status status-{{ capacitacion.Estado === 0 ? 'available' : 'closed' }}">
              {{ capacitacion.Estado === 0 ? 'Disponible' : 'Cerrada' }}
            </div>
            <h4>{{ capacitacion.Nombre_Capacitacion }}</h4>
            <div class="card-meta">
              <span><ion-icon name="calendar-outline"></ion-icon> {{ capacitacion.Fecha_Capacitacion | date:'dd MMM'
                }}</span>
              <span><ion-icon name="location-outline"></ion-icon> {{ capacitacion.Lugar_Capacitacion }}</span>
            </div>
            <button class="action-btn" *ngIf="puedeInscribirse(capacitacion)"
              (click)="inscribirse(capacitacion.Id_Capacitacion)">
              Inscribirse
            </button>
          </div>
        </div>
      </div>

      <!-- My Conferences -->
      <div class="content-block" *ngIf="ConferenciasInscritas.length > 0">
        <div class="block-header">
          <h3>Mis Inscripciones</h3>
          <a class="view-all" (click)="navegarModulo('Ver conferencias')">Gestionar</a>
        </div>

        <div class="list-container">
          <div class="list-item" *ngFor="let conferencia of ConferenciasInscritas">
            <div class="item-icon">
              <ion-icon name="school-outline"></ion-icon>
            </div>
            <div class="item-details">
              <h4>{{ conferencia.Nombre_Capacitacion }}</h4>
              <p>{{ conferencia.Fecha_Capacitacion | date:'dd/MM/yyyy HH:mm' }} • {{ conferencia.Modalidades }}</p>
            </div>
            <div class="item-action">
              <span class="status-badge status-{{ conferencia.Estado === 0 ? 'pending' : 'completed' }}">
                {{ conferencia.Estado === 0 ? 'Inscrito' : 'Completado' }}
              </span>
            </div>
          </div>
        </div>
      </div>

    </ng-container>

    <!-- Admin Dashboard Content: Recent Conferences -->
    <ng-container *ngIf="roleName() === 'Administrador' || roleName() === 'administrador'">
      <div class="content-block">
        <div class="block-header">
          <h3>Gestión Reciente</h3>
          <a class="view-all" (click)="navegarModulo('Gestionar capacitaciones')">Ir al módulo</a>
        </div>

        <div class="list-container">
          <div class="list-item" *ngFor="let capacitacion of capacitacionesDisponibles.slice(0, 5)">
            <div class="item-icon admin">
              <ion-icon name="create-outline"></ion-icon>
            </div>
            <div class="item-details">
              <h4>{{ capacitacion.Nombre_Capacitacion }}</h4>
              <p>{{ capacitacion.Fecha_Capacitacion | date:'dd/MM/yyyy' }} • {{ capacitacion.Lugar_Capacitacion }}</p>
            </div>
            <div class="item-action">
              <ion-button fill="clear" size="small" (click)="editarCapacitacion(capacitacion.Id_Capacitacion)">
                Editar
              </ion-button>
            </div>
          </div>
        </div>
      </div>
    </ng-container>

  </div>

  <!-- Services Grid (Navigation) -->
  <div class="container section-padding pt-0">
    <div class="section-header ion-text-center">
      <h3>Acceso Rápido</h3>
      <div class="separator"></div>
    </div>

    <!-- Admin Grid -->
    <div class="services-grid" *ngIf="roleName() === 'Administrador' || roleName() === 'administrador'">
      <div class="service-card" *ngFor="let modulo of modulos()" (click)="navegarModulo(modulo)">
        <div class="icon-circle">
          <ion-icon [name]="getIconForModule(modulo)"></ion-icon>
        </div>
        <h4>{{ modulo }}</h4>
        <p>Gestión administrativa</p>
        <div class="card-footer">
          <span>Acceder</span>
          <ion-icon name="arrow-forward"></ion-icon>
        </div>
      </div>
    </div>

    <!-- Public/User Grid -->
    <div class="services-grid" *ngIf="roleName() !== 'Administrador' && roleName()?.toLowerCase() !== 'administrador'">
      <div class="service-card" (click)="navegarModulo('Ver conferencias')">
        <div class="icon-circle">
          <ion-icon name="calendar-outline"></ion-icon>
        </div>
        <h4>Capacitaciones</h4>
        <p>Inscríbete en nuestros eventos y talleres formativos.</p>
        <div class="card-footer">
          <span>Ver eventos</span>
          <ion-icon name="arrow-forward"></ion-icon>
        </div>
      </div>

      <div class="service-card" (click)="navegarModulo('Ver certificaciones')">
        <div class="icon-circle">
          <ion-icon name="document-text-outline"></ion-icon>
        </div>
        <h4>Mis Certificados</h4>
        <p>Descarga tus certificados de aprobación académica.</p>
        <div class="card-footer">
          <span>Descargar</span>
          <ion-icon name="arrow-forward"></ion-icon>
        </div>
      </div>

      <div class="service-card" (click)="navegarModulo('Validar certificados')">
        <div class="icon-circle">
          <ion-icon name="qr-code-outline"></ion-icon>
        </div>
        <h4>Validar Certificados</h4>
        <p>Verifica la autenticidad de documentos emitidos.</p>
        <div class="card-footer">
          <span>Validar</span>
          <ion-icon name="arrow-forward"></ion-icon>
        </div>
      </div>

      <div class="service-card" (click)="navegarModulo('Ver Perfil')">
        <div class="icon-circle">
          <ion-icon name="person-outline"></ion-icon>
        </div>
        <h4>Mi Perfil</h4>
        <p>Actualiza tu información personal y profesional.</p>
        <div class="card-footer">
          <span>Gestionar</span>
          <ion-icon name="arrow-forward"></ion-icon>
        </div>
      </div>
    </div>
  </div>


  <!-- Institutional Info Section -->
  <div class="container section-padding pt-0">
    <div class="section-header ion-text-center">
      <h3>Información Institucional</h3>
      <div class="separator"></div>
    </div>

    <div class="info-grid">
      <div class="info-card" (click)="navegarModulo('historia')" routerLink="/home/historia">
        <div class="card-icon">
          <ion-icon name="time-outline"></ion-icon>
        </div>
        <ion-card-header>
          <ion-card-title>Historia</ion-card-title>
        </ion-card-header>
        <ion-card-content>
          <p>Conoce la trayectoria y evolución del CNC.</p>
        </ion-card-content>
      </div>

      <div class="info-card" (click)="navegarModulo('norma-regul')" routerLink="/home/norma-regul">
        <div class="card-icon">
          <ion-icon name="book-outline"></ion-icon>
        </div>
        <ion-card-header>
          <ion-card-title>Normativa</ion-card-title>
        </ion-card-header>
        <ion-card-content>
          <p>Marco legal, Constitución y COOTAD.</p>
        </ion-card-content>
      </div>

      <div class="info-card" (click)="navegarModulo('informacion')" routerLink="/home/informacion">
        <div class="card-icon">
          <ion-icon name="information-circle-outline"></ion-icon>
        </div>
        <ion-card-header>
          <ion-card-title>Información</ion-card-title>
        </ion-card-header>
        <ion-card-content>
          <p>Misión, visión y estructura organizacional.</p>
        </ion-card-content>
      </div>

      <div class="info-card" (click)="navegarModulo('direccion')" routerLink="/home/direccion">
        <div class="card-icon">
          <ion-icon name="location-outline"></ion-icon>
        </div>
        <ion-card-header>
          <ion-card-title>Dirección</ion-card-title>
        </ion-card-header>
        <ion-card-content>
          <p>Ubícanos y encuentra cómo llegar.</p>
        </ion-card-content>
      </div>

      <div class="info-card" (click)="navegarModulo('servi-progra')" routerLink="/home/servi-progra">
        <div class="card-icon">
          <ion-icon name="briefcase-outline"></ion-icon>
        </div>
        <ion-card-header>
          <ion-card-title>Servicios</ion-card-title>
        </ion-card-header>
        <ion-card-content>
          <p>Programas, eventos y servicios GAD.</p>
        </ion-card-content>
      </div>
    </div>
  </div>

  <!-- News Section (Visible mainly for guests or at bottom) -->
  <div class="news-section section-padding" *ngIf="!userName()">
    <div class="container">
      <div class="section-header ion-text-center">
        <h3>Noticias Recientes</h3>
        <div class="separator"></div>
      </div>

      <div class="news-grid">
        <div class="news-card">
          <div class="news-image placeholder-blue">
            <ion-icon name="newspaper-outline"></ion-icon>
          </div>
          <div class="news-content">
            <span class="news-date">22 Ene 2026</span>
            <h4>Nuevo Plan de Capacitación 2026</h4>
            <p>Conoce el cronograma de capacitaciones para el primer trimestre del año.</p>
            <a href="#">Leer más</a>
          </div>
        </div>
        <!-- More news cards... -->
        <div class="news-card">
          <div class="news-image placeholder-green">
            <ion-icon name="leaf-outline"></ion-icon>
          </div>
          <div class="news-content">
            <span class="news-date">20 Ene 2026</span>
            <h4>Descentralización Ambiental</h4>
            <p>Avances en la transferencia de competencias ambientales a los GADs.</p>
            <a href="#">Leer más</a>
          </div>
        </div>

        <div class="news-card">
          <div class="news-image placeholder-orange">
            <ion-icon name="people-outline"></ion-icon>
          </div>
          <div class="news-content">
            <span class="news-date">18 Ene 2026</span>
            <h4>Encuentro Nacional de Prefectos</h4>
            <p>Resultados del último encuentro para la equidad territorial.</p>
            <a href="#">Leer más</a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="main-footer">
    <div class="container">
      <div class="footer-grid">
        <div class="footer-col">
          <h4>Contacto</h4>
          <p><ion-icon name="location-outline"></ion-icon> Amazonas N38-42 y Villalengua, Quito-Ecuador</p>
          <p><ion-icon name="call-outline"></ion-icon> (593) 2 393 72 00</p>
          <p><ion-icon name="mail-outline"></ion-icon> info&#64;competencias.gob.ec</p>
        </div>
        <div class="footer-col">
          <h4>Enlaces Rápidos</h4>
          <ul>
            <li><a href="#">Transparencia</a></li>
            <li><a href="#">Servicios en Línea</a></li>
            <li><a href="#">Biblioteca Digital</a></li>
            <li><a href="#">Contáctenos</a></li>
          </ul>
        </div>
        <div class="footer-col">
          <h4>Síguenos</h4>
          <div class="social-links">
            <a href="#"><ion-icon name="logo-facebook"></ion-icon></a>
            <a href="#"><ion-icon name="logo-twitter"></ion-icon></a>
            <a href="#"><ion-icon name="logo-youtube"></ion-icon></a>
            <a href="#"><ion-icon name="logo-instagram"></ion-icon></a>
          </div>
        </div>
      </div>
      <div class="footer-bottom ion-text-center">
        <p>&copy; 2026 Consejo Nacional de Competencias. Todos los derechos reservados.</p>
      </div>
    </div>
  </footer>

</ion-content>