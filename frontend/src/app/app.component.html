<ion-app [class.has-global-header]="showHeader()">
  <!-- Menú lateral -->
  <ion-menu side="start" content-id="main-content" (ionWillOpen)="handleMenuWillOpen()" (ionDidOpen)="handleMenuOpen()"
    (ionDidClose)="handleMenuClose()">
    <ion-header class="menu-header-bar">
      <ion-toolbar>
        <div class="brand-logo">
          <img src="assets/cnc.png" alt="Logo">
          <span>CNC Portal</span>
        </div>
      </ion-toolbar>
    </ion-header>

    <ion-content class="menu-content">
      <ion-list lines="none">

        <!-- INICIO -->
        <ion-item button detail="false" (click)="navegarModulo('/')" class="menu-item">
          <ion-icon name="home-outline" slot="start"></ion-icon>
          <ion-label>Inicio</ion-label>
        </ion-item>

        <!-- LOGIN / PERFIL -->
        <div class="menu-section-group">
          <ion-item *ngIf="!userName()" button detail="false" (click)="iraLogin()" class="menu-item highlight-btn">
            <ion-icon name="log-in-outline" slot="start"></ion-icon>
            <ion-label>Iniciar Sesión</ion-label>
          </ion-item>

          <ion-item *ngIf="!userName()" button detail="false" (click)="iraRegistro()" class="menu-item highlight-btn">
            <ion-icon name="person-add-outline" slot="start"></ion-icon>
            <ion-label>Crear Cuenta</ion-label>
          </ion-item>

          <ion-item *ngIf="userName()" button detail="false" (click)="navegarModulo('Ver Perfil')"
            class="menu-item highlight-btn">
            <ion-icon name="person-circle-outline" slot="start"></ion-icon>
            <ion-label>Mi Perfil</ion-label>
          </ion-item>
        </div>

        <!-- MÓDULOS DE ROL (Si logueado) -->
        <ng-container *ngIf="userName()">
          <div class="section-label">GESTIÓN</div>
          <ion-item *ngFor="let modulo of modulos()" button detail="false" (click)="navegarModulo(modulo)"
            class="menu-item">
            <ion-icon [name]="getIconForModule(modulo)" slot="start"></ion-icon>
            <ion-label>{{ modulo }}</ion-label>
          </ion-item>
        </ng-container>

        <!-- INFORMACIÓN (Siempre visible o solo guest, según prefiera el usuario. Screenshot muestra guest view) -->
        <div class="section-label">INFORMACIÓN</div>

        <ion-item button detail="false" (click)="navegarModulo('informacion')" class="menu-item">
          <ion-icon name="information-circle-outline" slot="start"></ion-icon>
          <ion-label>Acerca de Nosotros</ion-label>
        </ion-item>
        <ion-item button detail="false" (click)="navegarModulo('direccion')" class="menu-item">
          <ion-icon name="location-outline" slot="start"></ion-icon>
          <ion-label>Dirección</ion-label>
        </ion-item>
        <ion-item button detail="false" (click)="navegarModulo('historia')" class="menu-item">
          <ion-icon name="book-outline" slot="start"></ion-icon>
          <ion-label>Historia</ion-label>
        </ion-item>
        <ion-item button detail="false" (click)="navegarModulo('norma-regul')" class="menu-item">
          <ion-icon name="document-text-outline" slot="start"></ion-icon>
          <ion-label>Norma Reguladora</ion-label>
        </ion-item>
        <ion-item button detail="false" (click)="navegarModulo('servi-progra')" class="menu-item">
          <ion-icon name="calendar-outline" slot="start"></ion-icon>
          <ion-label>Servicios y Programas</ion-label>
        </ion-item>

        <!-- VALIDAR -->
        <div class="menu-section-group">
          <ion-item button detail="false" (click)="navegarModulo('validar-certificados')"
            class="menu-item highlight-btn">
            <ion-icon name="qr-code-outline" slot="start"></ion-icon>
            <ion-label>Validar Certificados</ion-label>
          </ion-item>
        </div>

        <!-- LOGOUT -->
        <div class="menu-section-group" *ngIf="userName()">
          <ion-item button detail="false" (click)="cerrarSesion()" class="menu-item logout-btn">
            <ion-icon name="log-out-outline" slot="start"></ion-icon>
            <ion-label>Cerrar Sesión</ion-label>
          </ion-item>
        </div>

      </ion-list>
    </ion-content>
  </ion-menu>

  <!-- Header Global Persistente -->
  <app-header *ngIf="showHeader()"></app-header>

  <!-- Contenido principal -->
  <ion-router-outlet id="main-content" #mainContent tabindex="-1" style="outline: none;"></ion-router-outlet>
</ion-app>